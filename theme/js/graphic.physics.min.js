function HomePhysics(t){this.init(t)}HomePhysics.prototype.init=function(t){var i=t||{};this.pixelRatio=window.devicePixelRatio||1,this.canvasContainer=document.getElementById(i.containerID||"canvas"),this.boundingRect=this.canvasContainer.getBoundingClientRect(),this.boundingRectRatio={width:this.boundingRect.width/this.pixelRatio,height:this.boundingRect.height/this.pixelRatio},this.worldScale={x:1,y:1,initialScale:{width:this.boundingRect.width,height:this.boundingRect.height}},this.debugMode=i.debugMode||!1,this.initPhysics(),this.initGraphics(),this.buildWalls(),this.bodies=[],this.mouse=this.Mouse.create(this.app.renderer.view),mouseConstraint=this.MouseConstraint.create(this.engine,{mouse:this.mouse,constraint:{stiffness:.1,render:{visible:!1}}}),this.mouse.element.removeEventListener("mousewheel",this.mouse.mousewheel),this.mouse.element.removeEventListener("DOMMouseScroll",this.mouse.mousewheel),this.World.add(this.engine.world,mouseConstraint);var e=this;this.app.ticker.add(t=>{e.Engine.update(e.engine,16);for(var i=0;i<e.bodies.length;i++)e.bodies[i].body&&e.bodies[i].graphic&&(e.bodies[i].graphic.position=e.matterToPixiCoords(e.bodies[i].body.position),e.bodies[i].graphic.rotation=e.bodies[i].body.angle);TWEEN.update()}),this.resizeHandler=e.resize.bind(e),window.addEventListener("resize",e.resizeHandler,!0)},HomePhysics.prototype.clear=function(){window.removeEventListener("resize",this.resizeHandler,!0);for(var t=0;t<this.bodies.length;t++)this.removeShape(this.bodies[t]);this.app.stage.removeChild(this.sceneContainer),this.app.destroy(!0),this.removeWalls()},HomePhysics.prototype.initGraphics=function(t){this.app=new PIXI.Application({width:this.boundingRect.width/this.pixelRatio,height:this.boundingRect.height/this.pixelRatio,resolution:this.pixelRatio,transparent:!0}),this.canvasContainer.appendChild(this.app.view),this.sceneContainer=new PIXI.Container,this.sceneContainer.width=this.app.screen.width,this.sceneContainer.height=this.app.screen.height,this.sceneContainer.x=this.app.screen.width/2,this.sceneContainer.y=this.app.screen.height/2,this.app.stage.addChild(this.sceneContainer),this.debugMode&&this.app.renderer.view.setAttribute("data-lib","PIXI")},HomePhysics.prototype.initPhysics=function(t){this.Engine=Matter.Engine,this.Render=Matter.Render,this.Runner=Matter.Runner,this.World=Matter.World,this.Composite=Matter.Composite,this.Events=Matter.Events,this.Constraint=Matter.Constraint,this.MouseConstraint=Matter.MouseConstraint,this.Mouse=Matter.Mouse,this.Events=Matter.Events,this.Query=Matter.Query,this.Svg=Matter.Svg,this.Common=Matter.Common,this.Vertices=Matter.Vertices,this.Body=Matter.Body,this.Bodies=Matter.Bodies,this.engine=this.Engine.create(),this.engine.world.bounds.max.x=this.boundingRect.width,this.engine.world.bounds.max.y=this.boundingRect.height,this.debugMode&&(this.render=this.Render.create({element:this.canvasContainer,engine:this.engine,options:{width:this.boundingRect.width,height:this.boundingRect.height,wireframes:!1,background:"#ffffff"}}),this.Render.run(this.render),this.render.canvas.setAttribute("data-lib","Matter")),this.runner=this.Runner.create(),this.Runner.run(this.runner,this.engine),this.Engine.run(this.engine)},HomePhysics.prototype.resize=function(){var t=this.boundingRect;this.boundingRect=this.canvasContainer.getBoundingClientRect(),this.pixelRatio=window.devicePixelRatio||1,this.boundingRectRatio={width:this.boundingRect.width/this.pixelRatio,height:this.boundingRect.height/this.pixelRatio},this.worldScale.x=this.boundingRect.width/t.width,this.worldScale.y=this.boundingRect.height/t.height,this.app.renderer.resize(this.boundingRect.width/this.pixelRatio,this.boundingRect.height/this.pixelRatio),this.sceneContainer.width=this.boundingRect.width/this.pixelRatio,this.sceneContainer.height=this.boundingRect.height/this.pixelRatio,this.sceneContainer.x=this.boundingRect.width/(2*this.pixelRatio),this.sceneContainer.y=this.boundingRect.height/(2*this.pixelRatio),this.sceneContainer.scale.x=1,this.sceneContainer.scale.y=1,this.debugMode&&(this.render.canvas.width=this.boundingRect.width,this.render.canvas.height=this.boundingRect.height),this.engine.world.bounds.max.x=this.boundingRect.width,this.engine.world.bounds.max.y=this.boundingRect.height;var i=this.boundingRect.width*this.boundingRect.height>t.width*t.height;i&&this.buildWalls();for(var e=0;e<this.bodies.length;e++){var s=this.bodies[e];this.resizeShape(s)}i||this.buildWalls()},HomePhysics.prototype.setScale=function(t){var i=t.originalOptions;t.previousScale=t.scale;var e=i.size.maxHeight/100||.75,s=i.size.maxWidth/100||.75,o=e*this.boundingRectRatio.height*(i.svgSize.width/i.svgSize.height)/this.boundingRectRatio.width;i.hasToFit?t.scale=Math.min(s,o):t.scale=Math.max(s,o),t.scale*=this.boundingRect.width/this.worldScale.initialScale.width},HomePhysics.prototype.resizeShape=function(t){this.setScale(t);t.originalOptions;if(t.body){this.Body.scale(t.body,1/t.previousScale,1/t.previousScale),this.Body.scale(t.body,t.scale,t.scale);var i=t.body.position;this.Body.setPosition(t.body,{x:i.x*this.worldScale.x,y:i.y*this.worldScale.y}),t.graphicRotation=t.body.angle}if(t.graphic){var e=this;this.setGraphics(t,function(i){e.removeGraphics(t),t.graphic=i,e.sceneContainer.addChild(t.graphic)})}},HomePhysics.prototype.percentToPixel=function(t,i){return t*i/100},HomePhysics.prototype.matterToPixiCoords=function(t){return{x:t.x/this.pixelRatio-this.boundingRect.width/(2*this.pixelRatio),y:t.y/this.pixelRatio-this.boundingRect.height/(2*this.pixelRatio)}},HomePhysics.prototype.addShape=function(t){var i={};t?(t.type||(t.type="rectangle"),t.position||(t.position={x:0,y:0}),t.size||(t.position={maxWidth:this.percentToPixel(this.boundingRectRatio.width,12.5),maxHeight:this.percentToPixel(this.boundingRect.width,12.5)}),t.fillStyle||(t.fillStyle="#ff0000"),t.strokeStyle||(t.strokeStyle="transparent")):t={type:"rectangle",fillStyle:"#ff0000",originalFillStyle:"#ff0000",strokeStyle:"transparent",position:{x:0,y:0},size:{maxWidth:this.percentToPixel(this.boundingRectRatio.width,12.5),maxHeight:this.percentToPixel(this.boundingRectRatio.width,12.5)}};var e={fillStyle:t.fillStyle,originalFillStyle:t.fillStyle,strokeStyle:t.strokeStyle};return t.texture&&(e.sprite={texture:t.texture,xScale:1,yScale:1}),"svg"==t.type&&t.svgUrl?i=this.loadSVGShape(t):console.warn("You should define a svgUrl to load the shape"),i},HomePhysics.prototype.removeShape=function(t){t.graphic&&this.removeGraphics(t),t.body&&this.Composite.remove(this.engine.world,t.body),t={}},HomePhysics.prototype.setPhysicBody=function(t,i){var e=t.getAttribute("viewBox").split(" "),s={width:e[2]||t.width.baseVal.value||100,height:e[3]||t.height.baseVal.value||100};i.originalOptions.svgSize=s;var o=t.getElementsByTagName("path"),n=[],h=i.originalOptions;this.setScale(i);for(var r=i.scale*this.boundingRect.width/s.width,a=0;a<o.length;a++)var l=this.Svg.pathToVertices(o[a],2);var d=this.Bodies.fromVertices(this.percentToPixel(this.boundingRect.width,h.position.x),this.percentToPixel(this.boundingRect.height,h.position.y),l,{render:{fillStyle:"#00ff00",originalFillStyle:"transparent",strokeStyle:"transparent"}},!0);d?(this.Body.scale(d,r,r),n.push(d),this.World.add(this.engine.world,n),i.body=n[0],i.body.innerScale=r,h.angle&&this.Body.setAngle(i.body,h.angle)):console.warn("Could not create a shape based on the SVG element, probably because it is not made of only 1 path tag.",h)},HomePhysics.prototype.setGraphics=function(t,i){var e=t.originalOptions,s=new PIXI.Container;if(t.body){for(var o=new PIXI.Graphics,n=t.body.parts.length>1?1:0;n<t.body.parts.length;n++){part=t.body.parts[n],o.beginFill("0x"+e.fillStyle.substring(1)),o.moveTo((part.vertices[0].x-t.body.position.x)/this.pixelRatio,(part.vertices[0].y-t.body.position.y)/this.pixelRatio);for(var h=1;h<part.vertices.length;h++)o.lineTo((part.vertices[h].x-t.body.position.x)/this.pixelRatio,(part.vertices[h].y-t.body.position.y)/this.pixelRatio);o.lineTo((part.vertices[0].x-t.body.position.x)/this.pixelRatio,(part.vertices[0].y-t.body.position.y)/this.pixelRatio),o.endFill()}if(e.texture){s.texture=new PIXI.Sprite.fromImage(e.texture),s.texture.visible=!1,t.graphicRotation||(t.graphicRotation=0);var r=this;t.textureImage=new Image,t.textureImage.onload=function(){s.imgRatio=t.textureImage.width/t.textureImage.height,e.textureCover?(s.texture.width=r.percentToPixel(r.boundingRectRatio.width,100*t.scale),s.texture.height=r.percentToPixel(r.boundingRectRatio.width,100*t.scale)/s.imgRatio):(s.texture.width=t.textureImage.width,s.texture.height=t.textureImage.height),r.setMask(t,s,i)},t.textureImage.src=e.texture,s.texture.anchor.x=.5,s.texture.anchor.y=.5,s.texture.interactive=!0,s.texture.on("added",function(){}),s.addChild(s.texture),s.colorSprite=o,s.colorSprite.visible=!1,s.colorSprite.rotation=-t.graphicRotation,s.addChild(s.colorSprite)}else s.texture=o,s.addChild(s.texture);if(e.title){var a="0x000000";e.titleColor&&(a="0x"+e.titleColor.substring(1));var l=t.scale/(this.boundingRect.width/this.worldScale.initialScale.width),d=this.boundingRectRatio.width*l*.075;s.textStyle=new PIXI.TextStyle({fontFamily:"bzaregular, Arial",fontSize:d,fontWeight:700,fill:a,align:"center"}),s.text=new PIXI.Text(e.title.toUpperCase(),s.textStyle),s.text.position.x=-s.text.width/2,s.text.position.y=-s.text.height/2,s.text.visible=!1,s.addChild(s.text)}if(e.href){s.texture.cursor="pointer";var c={x:0,y:0};s.texture.on("mousedown",function(t){c.x=t.data.originalEvent.clientX,c.y=t.data.originalEvent.clientY}),s.texture.on("mouseup",function(t){var i=t.data.global;Math.abs(c.x-i.x)<20&&Math.abs(c.y-i.y)<20&&console.log(">>> should navigate to url",e.href)})}s.texture.on("mouseover",function(){s.text&&(s.text.visible=!0),s.colorSprite&&e.href&&(s.colorSprite.visible=!0)}),s.texture.on("mouseout",function(){s.text&&(s.text.visible=!1),s.colorSprite&&e.href&&(s.colorSprite.visible=!1)}),!e.texture&&i&&i(s)}},HomePhysics.prototype.setMask=function(t,i,e){var s=t.originalOptions,o=new PIXI.Graphics,n=t.body.position.x,h=t.body.position.y,r=1/this.pixelRatio;s.textureCover&&(r=100);for(var a=t.body.parts.length>1?1:0;a<t.body.parts.length;a++){part=t.body.parts[a],o.beginFill("0x00ff00"),o.moveTo((part.vertices[0].x-n)*r,(part.vertices[0].y-h)*r);for(var l=1;l<part.vertices.length;l++)o.lineTo((part.vertices[l].x-n)*r,(part.vertices[l].y-h)*r);o.lineTo((part.vertices[0].x-n)*r,(part.vertices[0].y-h)*r),o.endFill()}o.rotation=-t.graphicRotation,i.texture.mask=o,i.texture.addChild(o),i.texture.visible=!0,e&&e(i)},HomePhysics.prototype.removeGraphics=function(t){t.graphic.colorSprite&&t.graphic.removeChild(t.graphic.colorSprite),t.graphic.text&&t.graphic.removeChild(t.graphic.text),t.graphic.texture&&(t.graphic.removeChild(t.graphic.texture),t.graphic.texture.mask&&(t.graphic.removeChild(t.graphic.texture.mask),t.graphic.texture.mask=null)),this.sceneContainer.removeChild(t.graphic)},HomePhysics.prototype.loadSVGShape=function(t){var i=new XMLHttpRequest,e=this,s={scale:1,previousScale:1};i.onreadystatechange=function(){if(4==i.readyState&&(200==i.status||0==i.status)){var o=i.responseXML.documentElement;return s.originalOptions=t,e.setPhysicBody(o,s),e.setGraphics(s,function(t){s.graphic=t,e.sceneContainer.addChild(s.graphic)}),e.bodies.push(s),s}if(404==i.status)return console.warn("SVG couldn't be loaded, shape has not been created",t),!1},i.open("GET",t.svgUrl,!0),i.overrideMimeType("image/svg+xml"),i.send(null)},HomePhysics.prototype.buildWalls=function(t){this.walls?(this.Body.scale(this.walls.ground,this.worldScale.x,1),this.Body.setPosition(this.walls.ground,{x:this.boundingRect.width/2,y:this.boundingRect.height+40}),this.Body.scale(this.walls.leftWall,1,this.worldScale.y),this.Body.setPosition(this.walls.leftWall,{x:-40,y:this.boundingRect.height/2}),this.Body.scale(this.walls.rightWall,1,this.worldScale.y),this.Body.setPosition(this.walls.rightWall,{x:this.boundingRect.width+40,y:this.boundingRect.height/2}),this.Body.scale(this.walls.ceiling,this.worldScale.x,1),this.Body.setPosition(this.walls.ceiling,{x:this.boundingRect.width/2,y:-40})):(this.walls={},this.walls.ground=this.Bodies.rectangle(this.boundingRect.width/2,this.boundingRect.height+40,this.boundingRect.width,80,{isStatic:!0,render:{visible:!1}}),this.walls.leftWall=this.Bodies.rectangle(-40,this.boundingRect.height/2,80,this.boundingRect.height,{isStatic:!0,render:{visible:!1}}),this.walls.rightWall=this.Bodies.rectangle(this.boundingRect.width+40,this.boundingRect.height/2,80,this.boundingRect.height,{isStatic:!0,render:{visible:!1}}),this.walls.ceiling=this.Bodies.rectangle(this.boundingRect.width/2,-40,this.boundingRect.width,80,{isStatic:!0,render:{visible:!1}}),this.World.add(this.engine.world,[this.walls.ground,this.walls.leftWall,this.walls.rightWall,this.walls.ceiling]))},HomePhysics.prototype.removeWalls=function(){this.walls&&(this.Composite.remove(this.engine.world,this.walls.ground),this.Composite.remove(this.engine.world,this.walls.leftWall),this.Composite.remove(this.engine.world,this.walls.rightWall),this.Composite.remove(this.engine.world,this.walls.ceiling),this.walls={})};